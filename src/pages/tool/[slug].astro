---
import '../../styles/global.css';
import tools from '../../data/tools.js';
import slugify from '../../utils/slugify.js';
import SEO from '../../components/SEO.astro';
import Layout from '../../components/Layout.astro';

export async function getStaticPaths() {
  return tools.map(tool => ({
    params: { slug: slugify(tool.name) }
  }));
}

const { slug } = Astro.params;
const tool = tools.find(t => slugify(t.name) === slug);
if (!tool) {
  throw new Error(`Tool "${slug}" not found`);
}

const schemaData = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": tool.name,
  "description": tool.description,
  "url": tool.url,
  "applicationCategory": "Productivity"
};

const seoProps = {
  title: `${tool.name} - AI Tool | Toolaroo`,
  description: tool.description,
  type: "article",
  schema: schemaData
};
---

<Layout title={tool.name} description={tool.description} seoProps={seoProps}>
  <section class="py-20 sm:py-32 pb-3 border-b border-slate-200">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Tool Logo and Title in Row -->
      <div class="flex items-center justify-center gap-4 mb-6">
        <img
          src={`https://www.google.com/s2/favicons?sz=64&domain=${tool.url}`}
          alt={`${tool.name} logo`}
          class="w-16 h-16 rounded-lg shadow-md flex-shrink-0"
        />
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-slate-900 leading-tight">
          {tool.name} <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">AI Tool</span>
        </h1>
      </div>
      <div class="text-center">
      <p class="text-lg sm:text-xl text-slate-600 mb-6">{tool.description}</p>
      <div class="flex flex-wrap gap-3 justify-center">
        <span class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg font-medium capitalize">{tool.category}</span>
        {tool.featured && (
          <span class="px-4 py-2 bg-yellow-100 text-yellow-700 rounded-lg font-medium">⭐ Featured</span>
        )}
      </div>
    </div>
  </section>

  <section class="py-8 sm:py-12">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 space-y-16">
      <!-- Stats -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
        <div class="bg-white p-8 rounded-xl shadow-md border border-slate-200">
          <h3 class="text-sm font-semibold text-slate-600 uppercase mb-2">Rank</h3>
          <p class="text-3xl font-bold text-slate-900">#{tool.rank || 'N/A'}</p>
        </div>
        <div class="bg-white p-8 rounded-xl shadow-md border border-slate-200">
          <h3 class="text-sm font-semibold text-slate-600 uppercase mb-2">Status</h3>
          <p class="text-xl font-bold text-slate-900">{tool.featured ? '⭐ Featured' : 'Listed'}</p>
        </div>
        <div class="bg-white p-8 rounded-xl shadow-md border border-slate-200">
          <h3 class="text-sm font-semibold text-slate-600 uppercase mb-2">Category</h3>
          <p class="text-xl font-bold text-slate-900 capitalize">{tool.category}</p>
        </div>
      </div>

      <!-- CTA Buttons -->
      <div class="flex flex-col sm:flex-row gap-4">
        <a
          href={tool.url}
          target="_blank"
          rel="noopener noreferrer"
          class="flex-1 text-center px-8 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold shadow-lg hover:shadow-xl"
        >
          Open Tool →
        </a>
        <a
          href={`/category/${slugify(tool.category)}`}
          class="flex-1 text-center px-8 py-4 bg-slate-200 text-slate-900 rounded-lg hover:bg-slate-300 transition-colors font-semibold"
        >
          More {tool.category} Tools
        </a>
      </div>

      {/* Long Description */}
      {tool.longDescription && (
        <div class="prose prose-slate max-w-none">
          <h2 class="text-3xl font-bold text-slate-900 mb-6">About {tool.name}</h2>
          {tool.longDescription.split('\n\n').map((para) => (
            <p class="text-lg text-slate-700 leading-relaxed mb-4">{para}</p>
          ))}
        </div>
      )}

      {/* Key Features */}
      {tool.features && tool.features.length > 0 && (
        <div class="prose prose-slate max-w-none">
          <h2 class="text-3xl font-bold text-slate-900 mb-6">Key Features</h2>
          <ul class="grid grid-cols-1 md:grid-cols-2 gap-4 list-none pl-0">
            {tool.features.map((feature) => (
              <li class="flex items-start gap-3 text-lg text-slate-700">
                <span class="text-blue-600 font-bold text-xl mt-1">✨</span>
                <span>{feature}</span>
              </li>
            ))}
          </ul>
        </div>
      )}

      {/* Best Use Cases */}
      {tool.useCases && tool.useCases.length > 0 && (
        <div class="prose prose-slate max-w-none">
          <h2 class="text-3xl font-bold text-slate-900 mb-6">Best Use Cases</h2>
          <ul class="space-y-2 list-disc list-inside text-lg text-slate-700">
            {tool.useCases.map((useCase) => (
              <li>{useCase}</li>
            ))}
          </ul>
        </div>
      )}

      {/* Pricing */}
      {tool.pricing && (
        <div class="prose prose-slate max-w-none">
          <h2 class="text-3xl font-bold text-slate-900 mb-6">Pricing Plans</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {Object.entries(tool.pricing).map(([plan, description]) => (
              <div class="bg-slate-50 p-6 rounded-lg border border-slate-200">
                <h3 class="font-bold text-lg text-slate-900 mb-2 capitalize">{plan}</h3>
                <p class="text-slate-700">{description}</p>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* Pros & Cons */}
      {(tool.pros || tool.cons) && (
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          {tool.pros && (
            <div class="prose prose-slate max-w-none">
              <h3 class="text-2xl font-bold text-green-600 mb-4">✅ Pros</h3>
              <ul class="space-y-2 list-disc list-inside text-slate-700">
                {tool.pros.map((pro) => (
                  <li>{pro}</li>
                ))}
              </ul>
            </div>
          )}
          {tool.cons && (
            <div class="prose prose-slate max-w-none">
              <h3 class="text-2xl font-bold text-red-600 mb-4">❌ Cons</h3>
              <ul class="space-y-2 list-disc list-inside text-slate-700">
                {tool.cons.map((con) => (
                  <li>{con}</li>
                ))}
              </ul>
            </div>
          )}
        </div>
      )}

      {/* Alternatives */}
      {tool.alternatives && tool.alternatives.length > 0 && (
        <div class="prose prose-slate max-w-none">
          <h2 class="text-3xl font-bold text-slate-900 mb-6">Alternatives to {tool.name}</h2>
          <div class="space-y-3">
            {tool.alternatives.map((alt) => (
              <div class="flex items-start gap-3 text-lg text-slate-700">
                <span class="text-blue-600 font-bold">→</span>
                <div>
                  <strong>{alt.name}</strong> — {alt.reason}
                </div>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* FAQ */}
      {tool.faqItems && tool.faqItems.length > 0 && (
        <div class="prose prose-slate max-w-none">
          <h2 class="text-3xl font-bold text-slate-900 mb-6">Frequently Asked Questions</h2>
          <div class="space-y-6">
            {tool.faqItems.map((item, idx) => (
              <div key={idx} class="bg-slate-50 p-6 rounded-lg border border-slate-200">
                <h3 class="font-bold text-lg text-slate-900 mb-2">{item.question}</h3>
                <p class="text-slate-700">{item.answer}</p>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  </section>
</Layout>
